<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chef Audit - Admin Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root { --gold: #D4AF37; --black: #050505; --grey: #1a1a1a; --text: #e0e0e0; }
        body { font-family: 'Inter', sans-serif; background-color: var(--black); color: var(--text); margin: 0; padding: 20px; }
        
        .dashboard-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--gold); padding-bottom: 20px; margin-bottom: 30px; }
        .logo-text { font-family: 'Playfair Display', serif; font-size: 24px; color: var(--gold); letter-spacing: 2px; }
        
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .stat-card { background: var(--grey); padding: 20px; border-radius: 8px; border-left: 4px solid var(--gold); text-align: center; }
        .stat-card h3 { font-size: 11px; text-transform: uppercase; color: #888; margin: 0; }
        .stat-card p { font-size: 24px; font-weight: bold; margin: 10px 0 0; color: var(--gold); }

        .audit-table-container { background: var(--grey); border-radius: 8px; overflow-x: auto; }
        table { width: 100%; border-collapse: collapse; min-width: 600px; }
        th { background: #252525; color: var(--gold); padding: 15px; text-align: left; font-size: 12px; text-transform: uppercase; }
        td { padding: 15px; border-bottom: 1px solid #333; font-size: 14px; }
        
        .badge { padding: 5px 10px; border-radius: 20px; font-size: 11px; font-weight: bold; }
        .badge-elite { background: rgba(212, 175, 55, 0.2); color: var(--gold); border: 1px solid var(--gold); }
        .badge-training { background: rgba(244, 67, 54, 0.2); color: #f44336; border: 1px solid #f44336; }
        
        /* Overlay Login */
        #login-overlay { position:fixed; top:0; left:0; width:100%; height:100%; background:black; z-index:9999; display:flex; align-items:center; justify-content:center; }
    </style>
</head>
<body>

    <div id="login-overlay">
        <div style="border: 1px solid #D4AF37; padding: 40px; text-align: center; background: #1a1a1a; border-radius: 8px; width: 300px;">
            <h2 style="color:#D4AF37; font-family: 'Playfair Display';">ACCES AUDITOR</h2>
            <input type="password" id="auditor-code" placeholder="Cod Acces" style="background:black; border:1px solid #D4AF37; color:white; padding:10px; text-align:center; margin-bottom:20px; width: 100%; box-sizing: border-box;">
            <button onclick="checkAccess()" style="background:#D4AF37; color:black; border:none; padding:10px 30px; cursor:pointer; font-weight:bold; width: 100%;">AUTENTIFICARE</button>
            <p id="error-msg" style="color:red; font-size:11px; margin-top:10px; display:none;">Cod invalid. Acces refuzat.</p>
        </div>
    </div>

    <div class="dashboard-header">
        <div class="logo-text">CHEF AUDIT <span style="font-weight: 100; font-size: 16px;">| Control Panel</span></div>
        <div style="display: flex; align-items: center; gap: 20px;">
            <button onclick="deschideFormularAudit()" style="background: var(--gold); color: black; border: none; padding: 10px 20px; font-weight: bold; cursor: pointer; border-radius: 4px;">+ AUDIT NOU</button>
            <div id="current-date" style="font-size: 14px; color: #888;"></div>
        </div>
    </div>

    <div class="stats-grid">
        <div class="stat-card"><h3>Total Audituri</h3><p>48</p></div>
        <div class="stat-card"><h3>Sesiune Activă</h3><p id="display-id" style="font-size: 16px;">-</p></div>
        <div class="stat-card"><h3>Data</h3><p style="font-size: 16px;">22 Dec 2025</p></div>
    </div>

    <div id="historicul-auditorului" style="margin-top: 30px;">
        <h3 style="color: var(--gold); font-family: 'Playfair Display';">ISTORIC AUDITURI: <span id="nume-auditor-header"></span></h3>
        <div class="audit-table-container">
            <table>
                <thead>
                    <tr>
                        <th>Data</th>
                        <th>Locație/Chef</th>
                        <th>Scor</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody id="lista-istoric"></tbody>
            </table>
        </div>
    </div>

    <div style="margin-top: 50px; text-align: center;">
        <h3 style="color: var(--gold);">CARD IDENTITATE DIGITALĂ</h3>
        <div id="capture-area" style="padding: 20px; background: #000; display: inline-block;">
            <div id="auditor-card" style="width: 300px; min-height: 450px; background: #000; border: 2px solid #D4AF37; border-radius: 15px; padding: 25px; color: white; text-align: center;">
                <p style="font-size: 10px; letter-spacing: 4px; color: #D4AF37; margin-bottom: 15px;">OFFICIAL AUDITOR</p>
                <img src="https://gsandu18.github.io/logo-bucatarul-personal.png" style="width: 100px; margin-bottom: 15px;">
                <div style="width: 90px; height: 90px; border: 2px solid #D4AF37; margin: 0 auto 15px; border-radius: 50%; overflow: hidden; background: #111;">
                    <img src="https://via.placeholder.com/100" id="card-photo" style="width: 100%; height: 100%; object-fit: cover;">
                </div>
                <h2 id="card-name" style="font-family: 'Playfair Display', serif; margin: 5px 0; color: #D4AF37; font-size: 20px;">NUME AUDITOR</h2>
                <div style="display: flex; justify-content: center; background: white; padding: 8px; width: 80px; height: 80px; margin: 15px auto; border-radius: 5px;">
                    <img id="card-qr" src="" style="width: 100%; height: auto;">
                </div>
                <p style="font-size: 14px; font-weight: bold; color: #D4AF37;">ID: <span id="card-id-display"></span></p>
            </div>
        </div>
        <br>
        <button onclick="downloadCard()" style="margin-top: 20px; background: #D4AF37; color: black; border: none; padding: 12px 25px; font-weight: bold; cursor: pointer; border-radius: 5px;">DESCARCĂ CARD PNG</button>
    </div>

    <div id="modal-audit" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); z-index:10000; align-items:center; justify-content:center; padding: 20px; box-sizing: border-box;">
        <div style="background: var(--grey); border: 1px solid var(--gold); padding: 30px; width: 100%; max-width: 450px; border-radius: 8px; position: relative;">
            <span onclick="inchideFormular()" style="position:absolute; top:10px; right:15px; color:#888; cursor:pointer; font-size:24px;">&times;</span>
            <h2 style="color:var(--gold); font-family:'Playfair Display'; margin-top:0;">ÎNREGISTRARE AUDIT NOU</h2>
            <form id="form-audit-nou" onsubmit="salveazaAudit(event)">
                <label style="display:block; font-size:11px; color:#888; margin-bottom:5px;">NUME RESTAURANT / CHEF</label>
                <input type="text" id="audit-subiect" required style="width:100%; padding:12px; background:#000; border:1px solid #333; color:white; margin-bottom:20px; border-radius:4px;">
                <label style="display:block; font-size:11px; color:#888; margin-bottom:5px;">SCOR EVALUARE (0-100)</label>
                <input type="number" id="audit-scor" min="0" max="100" required style="width:100%; padding:12px; background:#000; border:1px solid #333; color:white; margin-bottom:20px; border-radius:4px;">
                <button type="submit" style="width:100%; background:var(--gold); color:black; border:none; padding:15px; font-weight:bold; cursor:pointer; text-transform:uppercase; border-radius:4px;">Finalizează și Salvează</button>
            </form>
        </div>
    </div>

    <script>
        const auditoriAutorizati = { "CHEF001": "Adrian Popescu", "AUDIT002": "Maria Ionescu" };
        const dateAudituri = [
            { auditorId: "CHEF001", data: "15.12.2025", nume: "Restaurant Le Premier", scor: "95/100", status: "ELITE" },
            { auditorId: "CHEF001", data: "10.12.2025", nume: "Chef Mario R.", scor: "88/100", status: "APPROVED" },
            { auditorId: "AUDIT002", data: "18.12.2025", nume: "Bistro Central", scor: "65/100", status: "TRAINING" }
        ];

        document.getElementById('current-date').innerText = "Data: " + new Date().toLocaleDateString('ro-RO');

        function checkAccess() {
            const code = document.getElementById('auditor-code').value;
            if (auditoriAutorizati[code]) {
                document.getElementById('login-overlay').style.display = 'none';
                document.getElementById('nume-auditor-header').innerText = auditoriAutorizati[code];
                document.getElementById('card-name').innerText = auditoriAutorizati[code];
                document.getElementById('display-id').innerText = code;
                document.getElementById('card-id-display').innerText = code;
                document.getElementById('card-qr').src = `https://api.qrserver.com/v1/create-qr-code/?size=100x100&data=https://gsandu18.github.io/verify/index.html?id=${code}`;
                afiseazaIstoric(code);
            } else { document.getElementById('error-msg').style.display = 'block'; }
        }

        function afiseazaIstoric(auditorId) {
            const lista = document.getElementById('lista-istoric');
            lista.innerHTML = "";
            const audituriMele = dateAudituri.filter(a => a.auditorId === auditorId);
            audituriMele.forEach(audit => {
                const color = audit.status === 'TRAINING' ? '#ff4444' : '#D4AF37';
                lista.innerHTML += `<tr><td>${audit.data}</td><td><b>${audit.nume}</b></td><td style="color:var(--gold)">${audit.scor}</td><td><span class="badge" style="border:1px solid ${color}; color:${color}">${audit.status}</span></td></tr>`;
            });
        }

        function deschideFormularAudit() { document.getElementById('modal-audit').style.display = 'flex'; }
        function inchideFormular() { document.getElementById('modal-audit').style.display = 'none'; }

        function salveazaAudit(event) {
            event.preventDefault();
            const subiect = document.getElementById('audit-subiect').value;
            const scorNum = document.getElementById('audit-scor').value;
            const auditorId = document.getElementById('display-id').innerText;
            const status = scorNum >= 90 ? "ELITE" : (scorNum >= 75 ? "APPROVED" : "TRAINING");

            dateAudituri.unshift({ auditorId: auditorId, data: new Date().toLocaleDateString('ro-RO'), nume: subiect, scor: scorNum + "/100", status: status });
            afiseazaIstoric(auditorId);
            inchideFormular();
            document.getElementById('form-audit-nou').reset();
            alert("Audit înregistrat cu succes!");
        }

        function downloadCard() {
            const area = document.getElementById('capture-area');
            html2canvas(area, { backgroundColor: "#000", scale: 2, useCORS: true }).then(canvas => {
                const link = document.createElement('a');
                link.download = `Chef-Audit-Card.png`;
                link.href = canvas.toDataURL();
                link.click();
            });
        }
    </script>
</body>
</html>
